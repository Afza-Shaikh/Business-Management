{% extends 'base.html' %}
{% block content %}
<h1 class="title">Ledger</h1>
<form method="get" class="box">
	<div class="field">
		<label class="label">Customer</label>
		<div class="select is-fullwidth">
			<select name="customer_id">
				<option value="">-- Select Customer --</option>
				{% for c in customers %}
				<option value="{{ c.id }}" {{ 'selected' if request.args.get('customer_id') == c.id|string else '' }}>{{ c.name }}</option>
				{% endfor %}
			</select>
		</div>
	</div>
	<button class="button is-link" type="submit">View</button>
</form>

{% if invoices %}
<div class="columns">
	<div class="column">
		<h2 class="subtitle">Invoices</h2>
		<table class="table is-fullwidth is-striped">
			<thead><tr><th>#</th><th>Date</th><th>Total</th></tr></thead>
			<tbody>
				{% for i in invoices %}
				<tr>
					<td><a href="/invoices/{{ i.id }}">{{ i.invoice_number }}</a></td>
					<td>{{ i.date.strftime('%Y-%m-%d') }}</td>
					<td>{{ 'Rs ' ~ '%.0f'|format(i.grand_total) }}</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
	<div class="column">
		<h2 class="subtitle">Payments</h2>
		<table class="table is-fullwidth is-striped">
			<thead><tr><th>Date</th><th>Amount</th><th>Method</th></tr></thead>
			<tbody>
				{% for p in payments %}
				<tr>
					<td>{{ p.date.strftime('%Y-%m-%d') }}</td>
					<td>{{ 'Rs ' ~ '%.0f'|format(p.amount) }}</td>
					<td>{{ p.method or '' }}</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
</div>
<div class="notification is-info">
	<strong>Outstanding Balance:</strong> {{ 'Rs ' ~ '%.0f'|format(balance) }}
</div>
{% endif %}
{% endblock %}
